import{u as S}from"./list-3fcef5d8.js";import{M as k}from"./Modal-6af97a3c.js";import{d as V,u as U,r as D,e as L,k as N,o as m,c as u,a as e,w as T,t as g,f as A,g as E,v as R,b as j,j as I,F as x,s as q,p as z,i as K,_ as G,l as H,m as $,n as w,q as B}from"./index-a4f8bda1.js";import{u as J}from"./useTMDBApi-62ef0368.js";const O={id:"creatListForm"},Q={class:"container"},W={class:"card card-body mt-4 mb-4"},X=["id","onSubmit"],Y={key:0,class:"error-message text-danger mb-4"},Z={class:"form-group"},P=e("label",{for:"listName"},"List name",-1),ee=["placeholder"],te=V({__name:"UpdateListForm",props:{validateForm:{type:Boolean},currentList:{},formId:{},modalIsVisible:{type:Boolean}},emits:["closeModal"],setup(i,{emit:a}){const t=i,h=S();U();const v=D({listName:""}),s=L("");N(()=>t.validateForm,async()=>{console.log("valideForm value from UpdateListForm",t.validateForm),console.log("modalIsVisible value from UpdateListForm",t.modalIsVisible),t.validateForm&&t.modalIsVisible?await f():a("closeModal",!1)});async function f(){console.log("SUBMIT is trigger from UpdateListForm"),await h.updateList(v,t.currentList.id).then(d=>{v.listName="",a("closeModal",!0)}).catch(d=>{console.log(d.message)})}return(d,c)=>{var b;return m(),u("div",O,[e("div",Q,[e("div",W,[e("form",{ref:"form",id:d.formId,onSubmit:T(f,["prevent"])},[s.value?(m(),u("p",Y,g(s.value),1)):A("",!0),e("div",Z,[P,E(e("input",{"onUpdate:modelValue":c[0]||(c[0]=M=>v.listName=M),type:"text",class:"form-control",id:"listName",placeholder:(b=t.currentList)==null?void 0:b.listName},null,8,ee),[[R,v.listName]])])],40,X)])])])}}}),se=i=>(z("data-v-643a1350"),i=i(),K(),i),oe={id:"creatListForm"},ie={class:"container"},ae={class:"card card-body mt-4 mb-4"},le=["id","onSubmit"],re={key:0,class:"error-message text-danger mb-4"},de={class:"form-group"},ne=se(()=>e("label",{for:"movieName"},"Movie name",-1)),ce={class:"list-group mt-4 mb-4"},me=["onClick"],ue={class:"row g-0"},ve={class:"col-md-4"},_e=["src"],pe={class:"col-md-8"},fe={class:"card-body"},ge={class:"card-title"},he={class:"card-text"},be={class:"card-text"},Me={class:"text-body-secondary"},ye=V({__name:"CreateMovieForm",props:{validateForm:{type:Boolean},currentList:{},formId:{},modalIsVisible:{type:Boolean}},emits:["closeModal"],setup(i,{emit:a}){const t=i,h=S(),v=U();j(),I(()=>v.user);const s=D({movieName:"",listId:t.currentList.id,apiMovieId:null}),f=L(""),d=L([]);async function c(o){(await J()).search.searchMovies({query:o.target.value}).then(_=>{d.value=_.results}).catch(_=>{console.log(_.message)})}function b(o){console.log("selectedMovie is trigger from CreateMovieForm"),s.movieName=o.original_title,s.apiMovieId=o.id}N(()=>t.currentList.id,o=>{s.listId=o}),N(()=>t.validateForm,async()=>{t.validateForm&&t.modalIsVisible?await M():a("closeModal",!1)});async function M(){console.log("SUBMIT is trigger from CreateMovieForm"),await h.createMovie(s).then(o=>{s.movieName="",s.apiMovieId=null,a("closeModal",!0)}).catch(o=>{console.log(o.message)})}return(o,_)=>(m(),u(x,null,[e("div",oe,[e("div",ie,[e("div",ae,[e("form",{ref:"form",id:t.formId,onSubmit:T(M,["prevent"])},[f.value?(m(),u("p",re,g(f.value),1)):A("",!0),e("div",de,[ne,E(e("input",{"onUpdate:modelValue":_[0]||(_[0]=n=>s.movieName=n),onKeyup:c,type:"text",class:"form-control",id:"movieName",placeholder:"movie name"},null,544),[[R,s.movieName]])])],40,le)])])]),e("div",ce,[(m(!0),u(x,null,q(d.value,n=>(m(),u("div",{onClick:p=>b(n),class:"list-group-item list-group-item-action card mb-3 user-select-none","data-bs-toggle":"list",style:{"max-width":"540px"},key:n.id},[e("div",ue,[e("div",ve,[e("img",{src:`https://image.tmdb.org/t/p/original/${n.poster_path}`,class:"img-fluid rounded-start",loading:"lazy",alt:"movie poster is missing"},null,8,_e)]),e("div",pe,[e("div",fe,[e("h5",ge,g(n.original_title),1),e("p",he,g(n.overview),1),e("p",be,[e("small",Me,g(n.release_date),1)])])])])],8,me))),128))])],64))}});const Le=G(ye,[["__scopeId","data-v-643a1350"]]),F=i=>(z("data-v-b5f17fc2"),i=i(),K(),i),Ie={class:"list-group"},$e={class:"list-group-item active d-flex align-items-center justify-content-between p-2 gap-4"},we=F(()=>e("a",{href:"/list",class:"text-white link-underline link-underline-opacity-0"}," < Prev ",-1)),xe={id:"button-container",class:"d-flex flex-row gap-4"},Fe=F(()=>e("button",{type:"button",class:"btn btn-light","data-bs-toggle":"modal","data-bs-target":"#editList"}," Edit List ",-1)),Ne=F(()=>e("button",{type:"button",class:"list-group-item list-group-item-primary","data-bs-toggle":"modal","data-bs-target":"#addMovie"}," + Add Movie ",-1)),Se=["href"],Ve={class:"ms-2 me-auto"},Ce={class:""},ke=F(()=>e("span",{class:"ms-4"},">",-1)),Be=V({__name:"MovieListView",setup(i){const a=S(),t=L(!1),h=j(),v=I(()=>a.list),s=L(v);async function f(){await a.getList()}H(async()=>{await f()});const d=h.currentRoute.value.params.listId,c=I(()=>s.value.find(l=>l.id===d)||{}),b=I(()=>a.movie),M=L(b),o=I(()=>M.value.filter(p=>p.listId.toString()===d));function _(p){if(confirm("Do you really want to delete your profile?")){a.deleteList(p);for(const l of o.value)a.deleteMovie(l.id);h.replace({name:"list"})}}const n=(p,l)=>`/movie/${p}`;return(p,l)=>{var C;return m(),u(x,null,[e("div",Ie,[e("div",$e,[we,e("div",null,g((C=c.value)==null?void 0:C.listName),1),e("div",xe,[e("button",{type:"button",class:"btn btn-danger",onClick:l[0]||(l[0]=r=>{var y;return _((y=c.value)==null?void 0:y.id)})}," Delete List "),Fe])]),Ne,(m(!0),u(x,null,q(o.value,r=>(m(),u("a",{href:n(r.id,r.apiMovieId),class:"list-group-item list-group-item-action d-flex align-items-start","aria-current":"true",key:r.id},[e("div",Ve,[e("div",Ce,g(r.movieName),1)]),ke],8,Se))),128))]),$(k,{"close-modal":t.value,"modal-id":"editList"},{title:w(()=>[B(" Edit List ")]),body:w(r=>[$(te,{"validate-form":r.validateForm,"modal-is-visible":r.modalIsVisible,"current-list":c.value,"form-id":"editList",onCloseModal:l[1]||(l[1]=y=>t.value=y)},null,8,["validate-form","modal-is-visible","current-list"])]),_:1},8,["close-modal"]),$(k,{"close-modal":t.value,"modal-id":"addMovie"},{title:w(()=>[B(" Add Movie ")]),body:w(r=>[$(Le,{"validate-form":r.validateForm,"modal-is-visible":r.modalIsVisible,"current-list":c.value,"form-id":"addMovie",onCloseModal:l[2]||(l[2]=y=>t.value=y)},null,8,["validate-form","modal-is-visible","current-list"])]),_:1},8,["close-modal"])],64)}}});const Ee=G(Be,[["__scopeId","data-v-b5f17fc2"]]);export{Ee as default};
