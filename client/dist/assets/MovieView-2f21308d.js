import{u as U}from"./list-3fcef5d8.js";import{M as R}from"./Modal-6af97a3c.js";import{d as B,u as q,r as z,e as h,k as j,o as c,c as v,a as e,w as K,t as m,f as Y,g as G,v as H,F as C,s as J,p as T,i as D,_ as E,b as O,j as L,l as P,x as Q,m as I,n as F,q as W}from"./index-a4f8bda1.js";import{u as A}from"./useTMDBApi-62ef0368.js";const X=a=>(T("data-v-b80d8a16"),a=a(),D(),a),Z={id:"creatListForm"},ee={class:"container"},oe={class:"card card-body mt-4 mb-4"},te=["id","onSubmit"],se={key:0,class:"error-message text-danger mb-4"},ie={class:"form-group"},ae=X(()=>e("label",{for:"movieName"},"Movie name",-1)),le=["placeholder"],de={class:"list-group mt-4 mb-4"},ne=["onClick"],re={class:"row g-0"},ce={class:"col-md-4"},ve=["src"],me={class:"col-md-8"},_e={class:"card-body"},ue={class:"card-title"},pe={class:"card-text"},he={class:"card-text"},ge={class:"text-body-secondary"},fe=B({__name:"UpdateMovieForm",props:{validateForm:{type:Boolean},currentMovie:{},formId:{},modalIsVisible:{type:Boolean}},emits:["closeModal"],setup(a,{emit:_}){const l=a,g=U();q();const d=z({movieName:"",apiMovieId:null}),s=h(""),f=h([]);async function w(i){(await A()).search.searchMovies({query:i.target.value}).then(n=>{f.value=n.results}).catch(n=>{console.log(n.message)})}function $(i){console.log("selectedMovie is trigger from CreateMovieForm"),d.movieName=i.original_title,d.apiMovieId=i.id}j(()=>l.validateForm,async()=>{console.log("valideForm value from UpdateListForm",l.validateForm),console.log("modalIsVisible value from UpdateListForm",l.modalIsVisible),l.validateForm&&l.modalIsVisible?await r():_("closeModal",!1)});async function r(){console.log("SUBMIT is trigger from UpdateListForm"),await g.updateMovie(d,l.currentMovie.id).then(i=>{d.movieName="",d.apiMovieId=null,_("closeModal",!0)}).catch(i=>{console.log(i.message)})}return(i,n)=>{var b;return c(),v(C,null,[e("div",Z,[e("div",ee,[e("div",oe,[e("form",{ref:"form",id:i.formId,onSubmit:K(r,["prevent"])},[s.value?(c(),v("p",se,m(s.value),1)):Y("",!0),e("div",ie,[ae,G(e("input",{"onUpdate:modelValue":n[0]||(n[0]=o=>d.movieName=o),onKeyup:w,type:"text",class:"form-control",id:"movieName",placeholder:(b=l.currentMovie)==null?void 0:b.movieName},null,40,le),[[H,d.movieName]])])],40,te)])])]),e("div",de,[(c(!0),v(C,null,J(f.value,o=>(c(),v("div",{onClick:t=>$(o),class:"list-group-item list-group-item-action card mb-3 user-select-none","data-bs-toggle":"list",style:{"max-width":"540px"},key:o.id},[e("div",re,[e("div",ce,[e("img",{src:`https://image.tmdb.org/t/p/original/${o.poster_path}`,class:"img-fluid rounded-start",loading:"lazy",alt:"movie poster is missing"},null,8,ve)]),e("div",me,[e("div",_e,[e("h5",ue,m(o.original_title),1),e("p",pe,m(o.overview),1),e("p",he,[e("small",ge,m(o.release_date),1)])])])])],8,ne))),128))])],64)}}});const be=E(fe,[["__scopeId","data-v-b80d8a16"]]),ye=a=>(T("data-v-20c8302d"),a=a(),D(),a),Me={id:"movieContainer"},we={class:"container"},$e={class:"card card-body mt-4"},xe=["href"],Ie={key:0,class:"card mb-3","data-bs-toggle":"list",style:{"max-width":"540px"}},Fe={class:"row g-0 mb-4"},ke={class:"col-md-4"},Se=["src"],Ve={class:"col-md-8"},Ne={class:"card-body"},Ce={class:"card-title"},Le={class:"card-text"},Ue={class:"card-text"},Be={class:"text-body-secondary"},Te=["data-plyr-embed-id"],De={key:1},Ee={id:"button-container",class:"d-flex flex-row-reverse p-2 gap-4"},Ae=ye(()=>e("button",{type:"button",class:"btn btn-primary","data-bs-toggle":"modal","data-bs-target":"#editMovie"}," Edit Movie ",-1)),Re=B({__name:"MovieView",setup(a){const _=U(),l=h(!1),g=O(),d=h(),s=h({});async function f(){await _.getList()}async function w(){d.value=g.currentRoute.value.params.movieId}const $=L(()=>{var t,y,u;const o=(u=(y=(t=s==null?void 0:s.value)==null?void 0:t.videos)==null?void 0:y.results)==null?void 0:u.filter(p=>p.site==="YouTube"&&p.type==="Trailer")[0].key;return console.log("tmdb state",s.value),console.log("movie trailer",o),o}),r=L(()=>{const o=_.movie.find(t=>t.id===d.value);return o!==void 0&&i(o.apiMovieId),o||{}});async function i(o){(await A()).endpoint.get(`movie/${o}`,{append_to_response:"videos"}).then(t=>{s.value=t,console.log("tmdb movie info from MovieView",t)}).catch(t=>{console.log(t.message)})}P(async()=>{await f(),await w()});function n(o,t){confirm("Do you really want to delete your profile?")&&(_.deleteMovie(o),g.push({name:"movieList",params:{listId:`${t}`}}))}const b=o=>`/list/${o}`;return(o,t)=>{var u,p,k,S,V;const y=Q("vue-plyr");return c(),v("div",Me,[e("div",we,[e("div",$e,[e("a",{href:b((u=r.value)==null?void 0:u.listId),class:"text-black link-underline link-underline-opacity-0 mb-4"}," < Prev ",8,xe),s.value.id?(c(),v("div",Ie,[e("div",Fe,[e("div",ke,[e("img",{src:`https://image.tmdb.org/t/p/original/${(p=s.value)==null?void 0:p.poster_path}`,class:"img-fluid rounded-start",loading:"lazy",alt:"movie poster is missing"},null,8,Se)]),e("div",Ve,[e("div",Ne,[e("h5",Ce,m((k=s.value)==null?void 0:k.original_title),1),e("p",Le,m((S=s.value)==null?void 0:S.overview),1),e("p",Ue,[e("small",Be,m((V=s.value)==null?void 0:V.release_date),1)])])])]),I(y,null,{default:F(()=>[e("div",{"data-plyr-provider":"youtube","data-plyr-embed-id":$.value},null,8,Te)]),_:1})])):(c(),v("div",De," Sorry for the inconvenience, but we can't retrieve the movie's informations ")),e("div",null,[e("div",Ee,[Ae,e("button",{type:"button",class:"btn btn-danger",onClick:t[0]||(t[0]=x=>{var M,N;return n((M=r.value)==null?void 0:M.id,(N=r.value)==null?void 0:N.listId)})}," Delete Movie ")]),I(R,{"close-modal":l.value,"modal-id":"editMovie"},{title:F(()=>[W(" Edit Movie ")]),body:F(x=>[I(be,{"validate-form":x.validateForm,"modal-is-visible":x.modalIsVisible,"current-movie":r.value,"form-id":"editMovie",onCloseModal:t[1]||(t[1]=M=>l.value=M)},null,8,["validate-form","modal-is-visible","current-movie"])]),_:1},8,["close-modal"])])])])])}}});const Ye=E(Re,[["__scopeId","data-v-20c8302d"]]);export{Ye as default};
